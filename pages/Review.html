<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Reviews & Testimonials - Camva Pro</title>
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <meta name="description" content="Read customer reviews and share your experience with Camva Pro.">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Poppins:wght@600;700;800&display=swap" rel="stylesheet">
  <style>
    :root {
      --brand-primary: #6366f1;
      --brand-secondary: #4f46e5;
      --brand-gradient: linear-gradient(135deg, #6366f1 0%, #4f46e5 100%);
      --success: #10b981;
      --warning: #f59e0b;
      --danger: #ef4444;
      --bg-primary: #ffffff;
      --bg-secondary: #f8fafc;
      --text-primary: #0f172a;
      --text-secondary: #475569;
      --text-light: #64748b;
      --border-color: #e2e8f0;
      --shadow-sm: 0 1px 2px rgba(0,0,0,0.05);
      --shadow-md: 0 4px 6px rgba(0,0,0,0.07);
      --shadow-lg: 0 10px 15px rgba(0,0,0,0.1);
      --shadow-xl: 0 25px 50px rgba(0,0,0,0.15);
      --radius-sm: 8px;
      --radius-md: 12px;
      --radius-lg: 18px;
      --radius-xl: 24px;
      --transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      line-height: 1.6;
      overflow-x: hidden;
    }

    /* Navigation */
    .navbar {
      position: fixed;
      top: 0;
      width: 100%;
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px);
      border-bottom: 1px solid var(--border-color);
      z-index: 1000;
      transition: all var(--transition);
    }

    .nav-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 24px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      height: 70px;
    }

    .logo {
      font-family: 'Poppins', sans-serif;
      font-size: 1.8rem;
      font-weight: 800;
      color: var(--brand-primary);
      text-decoration: none;
    }

    .nav-links {
      display: flex;
      list-style: none;
      gap: 32px;
      align-items: center;
    }

    .nav-links a {
      text-decoration: none;
      color: var(--text-secondary);
      font-weight: 500;
      transition: color var(--transition);
    }

    .nav-links a:hover {
      color: var(--brand-primary);
    }

    .cta-button {
      background: var(--brand-gradient);
      color: white;
      padding: 12px 24px;
      border-radius: var(--radius-md);
      text-decoration: none;
      font-weight: 600;
      transition: all var(--transition);
      border: none;
      cursor: pointer;
    }

    .cta-button:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-lg);
    }

    /* Main Container */
    .main-container {
      margin-top: 70px;
      padding: 60px 0;
      background: var(--bg-secondary);
      min-height: calc(100vh - 70px);
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 24px;
    }

    /* Header */
    .page-header {
      text-align: center;
      margin-bottom: 60px;
    }

    .page-header h1 {
      font-family: 'Poppins', sans-serif;
      font-size: 3rem;
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: 16px;
    }

    .page-header p {
      font-size: 1.2rem;
      color: var(--text-secondary);
      max-width: 600px;
      margin: 0 auto;
    }

    /* Connection Status */
    .connection-status {
      position: fixed;
      top: 80px;
      right: 20px;
      padding: 8px 16px;
      border-radius: 20px;
      font-size: 0.85rem;
      font-weight: 500;
      z-index: 999;
      transition: all var(--transition);
    }

    .connection-status.online {
      background: #ecfdf5;
      color: #065f46;
      border: 1px solid #a7f3d0;
    }

    .connection-status.offline {
      background: #fef2f2;
      color: #991b1b;
      border: 1px solid #fecaca;
    }

    /* Tab Navigation */
    .tab-navigation {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-bottom: 50px;
      position: relative;
    }

    .tab-button {
      padding: 16px 32px;
      border: 2px solid var(--border-color);
      background: var(--bg-primary);
      color: var(--text-secondary);
      border-radius: var(--radius-lg);
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all var(--transition);
      position: relative;
      overflow: hidden;
    }

    .tab-button::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: var(--brand-gradient);
      transition: left 0.5s ease;
      z-index: -1;
    }

    .tab-button.active::before {
      left: 0;
    }

    .tab-button.active {
      color: white;
      border-color: var(--brand-primary);
      transform: translateY(-2px);
      box-shadow: var(--shadow-lg);
    }

    .tab-button:hover:not(.active) {
      border-color: var(--brand-primary);
      transform: translateY(-1px);
    }

    /* Tab Content */
    .tab-content {
      display: none;
      animation: fadeIn 0.5s ease;
    }

    .tab-content.active {
      display: block;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Review Form Styles */
    .review-form-container {
      max-width: 600px;
      margin: 0 auto;
      background: var(--bg-primary);
      border-radius: var(--radius-xl);
      padding: 40px;
      box-shadow: var(--shadow-lg);
      position: relative;
      overflow: hidden;
    }

    .review-form-container::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: var(--brand-gradient);
    }

    .form-group {
      margin-bottom: 25px;
    }

    .form-label {
      display: block;
      font-weight: 600;
      margin-bottom: 8px;
      color: var(--text-primary);
      font-size: 1rem;
    }

    .form-input, .form-select, .form-textarea {
      width: 100%;
      padding: 16px;
      border: 2px solid var(--border-color);
      border-radius: var(--radius-md);
      font-size: 1rem;
      font-family: inherit;
      background: var(--bg-secondary);
      transition: all var(--transition);
      color: var(--text-primary);
      font-weight: 500;
    }

    .form-input:focus, .form-select:focus, .form-textarea:focus {
      outline: none;
      border-color: var(--brand-primary);
      background: white;
      box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.1);
      transform: translateY(-2px);
    }

    .form-textarea {
      min-height: 120px;
      resize: vertical;
    }

    /* Star Rating */
    .star-rating {
      display: flex;
      gap: 8px;
      margin-bottom: 8px;
    }

    .star {
      width: 32px;
      height: 32px;
      cursor: pointer;
      transition: all var(--transition);
      fill: #e2e8f0;
      filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));
    }

    .star:hover,
    .star.active {
      fill: #facc15;
      transform: scale(1.1) rotate(5deg);
      filter: drop-shadow(0 4px 8px rgba(250,204,21,0.3));
    }

    .rating-text {
      font-size: 0.9rem;
      color: var(--text-light);
      margin-top: 8px;
      font-weight: 500;
    }

    .submit-button {
      background: var(--brand-gradient);
      color: white;
      padding: 16px 32px;
      border: none;
      border-radius: var(--radius-md);
      font-size: 1.1rem;
      font-weight: 700;
      cursor: pointer;
      transition: all var(--transition);
      width: 100%;
      position: relative;
      overflow: hidden;
    }

    .submit-button::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
      transition: left 0.6s ease;
    }

    .submit-button:hover::before {
      left: 100%;
    }

    .submit-button:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-lg);
    }

    .submit-button:disabled {
      opacity: 0.7;
      cursor: not-allowed;
      transform: none;
    }

    /* Reviews Display */
    .reviews-container {
      position: relative;
    }

    .reviews-stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 30px;
      margin-bottom: 50px;
    }

    .stat-card {
      background: var(--bg-primary);
      padding: 30px;
      border-radius: var(--radius-xl);
      text-align: center;
      box-shadow: var(--shadow-md);
      transition: all var(--transition);
      position: relative;
      overflow: hidden;
    }

    .stat-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: var(--brand-gradient);
    }

    .stat-card:hover {
      transform: translateY(-4px);
      box-shadow: var(--shadow-lg);
    }

    .stat-number {
      font-size: 2.5rem;
      font-weight: 800;
      color: var(--brand-primary);
      margin-bottom: 8px;
      font-family: 'Poppins', sans-serif;
    }

    .stat-label {
      color: var(--text-secondary);
      font-weight: 500;
    }

    /* Carousel Container */
    .carousel-container {
      position: relative;
      overflow: hidden;
      margin: 40px 0;
      perspective: 1000px;
    }

    .carousel-wrapper {
      display: flex;
      transition: transform 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      gap: 30px;
      padding: 40px 0;
      transform-style: preserve-3d;
    }

    .review-card {
      flex: 0 0 400px;
      background: var(--bg-primary);
      border-radius: var(--radius-xl);
      padding: 30px;
      box-shadow: var(--shadow-md);
      transition: all var(--transition);
      position: relative;
      transform: scale(0.85) rotateY(15deg);
      opacity: 0.6;
      transform-origin: center;
    }

    .review-card.center {
      transform: scale(1) rotateY(0deg);
      opacity: 1;
      box-shadow: var(--shadow-xl);
      border: 2px solid var(--brand-primary);
      z-index: 10;
    }

    .review-card.prev {
      transform: scale(0.85) rotateY(15deg);
    }

    .review-card.next {
      transform: scale(0.85) rotateY(-15deg);
    }

    .review-header {
      display: flex;
      align-items: center;
      gap: 16px;
      margin-bottom: 20px;
    }

    .reviewer-avatar {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      background: var(--brand-gradient);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: 700;
      font-size: 1.5rem;
      box-shadow: var(--shadow-md);
      font-family: 'Poppins', sans-serif;
    }

    .reviewer-info h4 {
      font-weight: 600;
      margin-bottom: 4px;
      font-size: 1.1rem;
    }

    .reviewer-plan {
      font-size: 0.9rem;
      color: var(--text-light);
      background: var(--bg-secondary);
      padding: 4px 12px;
      border-radius: 12px;
      display: inline-block;
      font-weight: 500;
    }

    .review-stars {
      display: flex;
      gap: 4px;
      margin-bottom: 16px;
    }

    .review-stars svg {
      width: 20px;
      height: 20px;
      fill: #facc15;
      filter: drop-shadow(0 1px 2px rgba(0,0,0,0.1));
    }

    .review-text {
      color: var(--text-secondary);
      line-height: 1.7;
      font-size: 1rem;
      font-weight: 400;
    }

    .review-date {
      font-size: 0.85rem;
      color: var(--text-light);
      margin-top: 15px;
      text-align: right;
      font-style: italic;
    }

    /* Carousel Controls */
    .carousel-controls {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-top: 30px;
    }

    .carousel-btn {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      background: var(--bg-primary);
      border: 2px solid var(--border-color);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all var(--transition);
      color: var(--text-secondary);
      font-size: 1.5rem;
      font-weight: bold;
      box-shadow: var(--shadow-sm);
    }

    .carousel-btn:hover {
      border-color: var(--brand-primary);
      color: var(--brand-primary);
      transform: scale(1.1);
      box-shadow: var(--shadow-md);
    }

    .carousel-indicators {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-top: 25px;
    }

    .indicator {
      width: 14px;
      height: 14px;
      border-radius: 50%;
      background: var(--border-color);
      cursor: pointer;
      transition: all var(--transition);
      position: relative;
    }

    .indicator.active {
      background: var(--brand-primary);
      transform: scale(1.2);
    }

    .indicator:hover:not(.active) {
      background: var(--brand-secondary);
      transform: scale(1.1);
    }

    /* Alert Messages */
    .alert {
      padding: 16px 20px;
      border-radius: var(--radius-md);
      margin: 20px 0;
      font-weight: 500;
      animation: slideIn 0.4s ease;
      position: relative;
      overflow: hidden;
    }

    .alert::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 4px;
    }

    .alert-success {
      background: #ecfdf5;
      color: #065f46;
      border: 1px solid #a7f3d0;
    }

    .alert-success::before {
      background: var(--success);
    }

    .alert-error {
      background: #fef2f2;
      color: #991b1b;
      border: 1px solid #fecaca;
    }

    .alert-error::before {
      background: var(--danger);
    }

    @keyframes slideIn {
      from { opacity: 0; transform: translateX(-20px); }
      to { opacity: 1; transform: translateX(0); }
    }

    /* Loading Spinner */
    .loading-spinner {
      width: 20px;
      height: 20px;
      border: 2px solid rgba(255,255,255,0.3);
      border-radius: 50%;
      border-top-color: white;
      animation: spin 1s linear infinite;
      display: none;
      margin-right: 8px;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Progress Bar */
    .progress-bar {
      height: 4px;
      background: var(--bg-secondary);
      border-radius: 2px;
      overflow: hidden;
      margin-bottom: 20px;
    }

    .progress-fill {
      height: 100%;
      background: var(--brand-gradient);
      width: 0%;
      transition: width 0.3s ease;
      border-radius: 2px;
    }

    /* Empty State */
    .empty-state {
      text-align: center;
      padding: 60px 20px;
      color: var(--text-light);
    }

    .empty-state-icon {
      font-size: 4rem;
      margin-bottom: 20px;
      opacity: 0.5;
    }

    .empty-state h3 {
      font-size: 1.3rem;
      margin-bottom: 10px;
      color: var(--text-secondary);
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      .nav-links {
        display: none;
      }

      .page-header h1 {
        font-size: 2.2rem;
      }

      .tab-navigation {
        flex-direction: column;
        align-items: center;
        gap: 12px;
      }

      .tab-button {
        width: 100%;
        max-width: 300px;
      }

      .review-form-container {
        margin: 0 20px;
        padding: 30px 20px;
      }

      .review-card {
        flex: 0 0 320px;
        transform: scale(0.9);
      }

      .review-card.center {
        transform: scale(1);
      }

      .carousel-wrapper {
        gap: 20px;
      }

      .reviews-stats {
        grid-template-columns: 1fr 1fr;
        gap: 20px;
      }

      .container {
        padding: 0 20px;
      }

      .connection-status {
        position: relative;
        top: auto;
        right: auto;
        margin: 10px auto;
        display: block;
        width: fit-content;
      }
    }

    @media (max-width: 480px) {
      .reviews-stats {
        grid-template-columns: 1fr;
      }

      .review-card {
        flex: 0 0 280px;
      }

      .carousel-btn {
        width: 50px;
        height: 50px;
        font-size: 1.2rem;
      }

      .reviewer-avatar {
        width: 50px;
        height: 50px;
        font-size: 1.2rem;
      }
    }

    /* Dark mode support */
    @media (prefers-color-scheme: dark) {
      :root {
        --bg-primary: #1e293b;
        --bg-secondary: #0f172a;
        --text-primary: #f1f5f9;
        --text-secondary: #cbd5e1;
        --text-light: #94a3b8;
        --border-color: #334155;
      }
    }

    /* Smooth scrolling */
    html {
      scroll-behavior: smooth;
    }

    /* Focus styles for accessibility */
    .tab-button:focus,
    .carousel-btn:focus,
    .indicator:focus,
    .form-input:focus,
    .form-select:focus,
    .form-textarea:focus,
    .submit-button:focus {
      outline: 2px solid var(--brand-primary);
      outline-offset: 2px;
    }
  </style>
</head>
<body>
  <!-- Connection Status -->
  <div id="connectionStatus" class="connection-status online">
    üü¢ Connected
  </div>

  <!-- Navigation -->
  <nav class="navbar">
    <div class="nav-container">
      <a href="index.html" class="logo">Camva Pro</a>
      <ul class="nav-links">
        <li><a href="index.html">Home</a></li>
        <li><a href="index.html#features">Features</a></li>
        <li><a href="index.html#pricing">Pricing</a></li>
        <li><a href="giveaway.html">Giveaway</a></li>
        <li><a href="contact.html">Contact</a></li>
      </ul>
      <a href="freetrial.html" class="cta-button">Start Free Trial</a>
    </div>
  </nav>

  <!-- Main Container -->
  <div class="main-container">
    <div class="container">
      <!-- Page Header -->
      <div class="page-header">
        <h1>Reviews & Testimonials</h1>
        <p>Share your experience with Camva Pro or read what other creators are saying about our platform.</p>
      </div>

      <!-- Tab Navigation -->
      <div class="tab-navigation">
        <button class="tab-button active" onclick="switchTab('write-review')" aria-label="Write a Review">
          ‚úçÔ∏è Write a Review
        </button>
        <button class="tab-button" onclick="switchTab('all-reviews')" aria-label="View All Reviews">
          ‚≠ê View All Reviews (<span id="reviewCount">0</span>)
        </button>
      </div>

      <!-- Write Review Tab -->
      <div id="write-review" class="tab-content active">
        <div class="review-form-container">
          <h2 style="text-align: center; margin-bottom: 30px; color: var(--brand-primary); font-family: 'Poppins', sans-serif;">Share Your Experience</h2>
          
          <!-- Progress Bar -->
          <div class="progress-bar">
            <div class="progress-fill" id="formProgress"></div>
          </div>
          
          <form id="reviewForm">
            <div class="form-group">
              <label class="form-label" for="reviewerName">Your Name *</label>
              <input type="text" id="reviewerName" name="reviewerName" class="form-input" placeholder="Enter your full name" required maxlength="100" autocomplete="name">
            </div>

            <div class="form-group">
              <label class="form-label" for="planType">Subscription Plan *</label>
              <select id="planType" name="planType" class="form-select" required>
                <option value="">Select your plan</option>
                <option value="Monthly Plan">Monthly Plan (‚Çπ999/month)</option>
                <option value="Quarterly Plan">Quarterly Plan (‚Çπ2,499/3 months)</option>
                <option value="Annual Plan">Annual Plan (‚Çπ6,999/year)</option>
                <option value="Giveaway Winner">Giveaway Winner</option>
                <option value="Free Trial">Free Trial User</option>
              </select>
            </div>

            <div class="form-group">
              <label class="form-label">Rating *</label>
              <div class="star-rating" role="radiogroup" aria-label="Rating">
                <svg class="star" data-rating="1" viewBox="0 0 24 24" role="radio" aria-label="1 star" tabindex="0">
                  <path d="M12 17.3l6.18 4.03-1.64-7.19L21 9.76l-7.27-.63L12 2.5 10.27 9.13 3 9.76l4.46 4.38-1.64 7.19z"/>
                </svg>
                <svg class="star" data-rating="2" viewBox="0 0 24 24" role="radio" aria-label="2 stars" tabindex="0">
                  <path d="M12 17.3l6.18 4.03-1.64-7.19L21 9.76l-7.27-.63L12 2.5 10.27 9.13 3 9.76l4.46 4.38-1.64 7.19z"/>
                </svg>
                <svg class="star" data-rating="3" viewBox="0 0 24 24" role="radio" aria-label="3 stars" tabindex="0">
                  <path d="M12 17.3l6.18 4.03-1.64-7.19L21 9.76l-7.27-.63L12 2.5 10.27 9.13 3 9.76l4.46 4.38-1.64 7.19z"/>
                </svg>
                <svg class="star" data-rating="4" viewBox="0 0 24 24" role="radio" aria-label="4 stars" tabindex="0">
                  <path d="M12 17.3l6.18 4.03-1.64-7.19L21 9.76l-7.27-.63L12 2.5 10.27 9.13 3 9.76l4.46 4.38-1.64 7.19z"/>
                </svg>
                <svg class="star" data-rating="5" viewBox="0 0 24 24" role="radio" aria-label="5 stars" tabindex="0">
                  <path d="M12 17.3l6.18 4.03-1.64-7.19L21 9.76l-7.27-.63L12 2.5 10.27 9.13 3 9.76l4.46 4.38-1.64 7.19z"/>
                </svg>
              </div>
              <div class="rating-text" id="ratingText">Please select a rating</div>
            </div>

            <div class="form-group">
              <label class="form-label" for="reviewText">Your Review *</label>
              <textarea id="reviewText" name="reviewText" class="form-textarea" placeholder="Tell us about your experience with Camva Pro. What features do you love? How has it helped your work? Share specific details to help other creators." required maxlength="500"></textarea>
              <div style="text-align: right; font-size: 0.9rem; color: var(--text-light); margin-top: 5px;">
                <span id="charCount">0</span>/500 characters
              </div>
            </div>

            <button type="submit" class="submit-button">
              <div class="loading-spinner" id="submitSpinner"></div>
              <span id="submitText">Submit Review</span>
            </button>
          </form>

          <div id="formAlert"></div>
        </div>
      </div>

      <!-- All Reviews Tab -->
      <div id="all-reviews" class="tab-content">
        <!-- Stats Section -->
        <div class="reviews-stats">
          <div class="stat-card">
            <div class="stat-number" id="averageRating">5.0</div>
            <div class="stat-label">Average Rating</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="totalReviews">0</div>
            <div class="stat-label">Total Reviews</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="fiveStarPercent">100%</div>
            <div class="stat-label">5-Star Reviews</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="recommendPercent">98%</div>
            <div class="stat-label">Would Recommend</div>
          </div>
        </div>

        <!-- Reviews Carousel -->
        <div class="carousel-container">
          <div class="carousel-wrapper" id="reviewsCarousel">
            <!-- Reviews will be populated here -->
          </div>
          
          <div class="carousel-controls">
            <button class="carousel-btn" id="prevBtn" onclick="previousReview()" aria-label="Previous review">
              &#8249;
            </button>
            <button class="carousel-btn" id="nextBtn" onclick="nextReview()" aria-label="Next review">
              &#8250;
            </button>
          </div>
          
          <div class="carousel-indicators" id="carouselIndicators" role="tablist" aria-label="Review indicators">
            <!-- Indicators will be populated here -->
          </div>
        </div>

        <!-- Empty State -->
        <div id="emptyState" class="empty-state" style="display: none;">
          <div class="empty-state-icon">üìù</div>
          <h3>No Reviews Yet</h3>
          <p>Be the first to share your experience with Camva Pro!</p>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Configuration
    const API_URL = 'https://script.google.com/macros/s/AKfycbx33i_d8J8E8y_ZzeqSMpIMNFFCeTAWkyJ0mGsqAcZPWWzRT5hyKbpOKsHZIIRib5-ujw/exec';
    
    // Global variables
    let currentRating = 0;
    let reviews = [];
    let currentReviewIndex = 0;
    let isOnline = navigator.onLine;
    let autoRotateInterval = null;
    let formProgressInterval = null;

    // Initialize page
    document.addEventListener('DOMContentLoaded', function() {
      initializeStarRating();
      initializeCharacterCounter();
      initializeFormProgress();
      loadReviews();
      setupForm();
      updateConnectionStatus();
      setupNetworkListeners();
      setupKeyboardNavigation();
    });

    // Network status
    function setupNetworkListeners() {
      window.addEventListener('online', () => {
        isOnline = true;
        updateConnectionStatus();
        loadReviews(); // Refresh data when back online
      });
      
      window.addEventListener('offline', () => {
        isOnline = false;
        updateConnectionStatus();
      });
    }

    function updateConnectionStatus() {
      const statusEl = document.getElementById('connectionStatus');
      if (isOnline) {
        statusEl.className = 'connection-status online';
        statusEl.innerHTML = 'üü¢ Connected';
      } else {
        statusEl.className = 'connection-status offline';
        statusEl.innerHTML = 'üî¥ Offline';
      }
    }

    // Tab switching
    function switchTab(tabName) {
      // Update tab buttons
      document.querySelectorAll('.tab-button').forEach(btn => {
        btn.classList.remove('active');
      });
      event.target.classList.add('active');

      // Update tab content
      document.querySelectorAll('.tab-content').forEach(tab => {
        tab.classList.remove('active');
      });
      document.getElementById(tabName).classList.add('active');

      // Load reviews if switching to all reviews tab
      if (tabName === 'all-reviews') {
        loadReviews();
        startAutoRotate();
      } else {
        stopAutoRotate();
      }
    }

    // Star rating functionality
    function initializeStarRating() {
      const stars = document.querySelectorAll('.star');
      const ratingText = document.getElementById('ratingText');
      
      const ratingTexts = {
        1: '‚≠ê Poor - Not satisfied',
        2: '‚≠ê‚≠ê Fair - Below expectations', 
        3: '‚≠ê‚≠ê‚≠ê Good - Met expectations',
        4: '‚≠ê‚≠ê‚≠ê‚≠ê Great - Exceeded expectations',
        5: '‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê Excellent - Outstanding experience!'
      };

      stars.forEach((star, index) => {
        star.addEventListener('click', () => {
          currentRating = index + 1;
          updateStarDisplay();
          ratingText.textContent = ratingTexts[currentRating];
          updateFormProgress();
        });

        star.addEventListener('mouseenter', () => {
          highlightStars(index + 1);
        });

        star.addEventListener('keydown', (e) => {
          if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            star.click();
          }
        });
      });

      document.querySelector('.star-rating').addEventListener('mouseleave', () => {
        updateStarDisplay();
      });

      function highlightStars(rating) {
        stars.forEach((star, index) => {
          if (index < rating) {
            star.classList.add('active');
          } else {
            star.classList.remove('active');
          }
        });
      }

      function updateStarDisplay() {
        highlightStars(currentRating);
      }
    }

    // Character counter
    function initializeCharacterCounter() {
      const textarea = document.getElementById('reviewText');
      const charCount = document.getElementById('charCount');
      
      textarea.addEventListener('input', () => {
        const count = textarea.value.length;
        charCount.textContent = count;
        
        // Update progress
        updateFormProgress();
        
        // Color coding for character count
        if (count > 450) {
          charCount.style.color = 'var(--warning)';
        } else if (count > 400) {
          charCount.style.color = 'var(--brand-primary)';
        } else {
          charCount.style.color = 'var(--text-light)';
        }
      });
    }

    // Form progress tracking
    function initializeFormProgress() {
      const form = document.getElementById('reviewForm');
      const inputs = form.querySelectorAll('input[required], select[required], textarea[required]');
      
      inputs.forEach(input => {
        input.addEventListener('input', updateFormProgress);
        input.addEventListener('change', updateFormProgress);
      });
    }

    function updateFormProgress() {
      const name = document.getElementById('reviewerName').value.trim();
      const plan = document.getElementById('planType').value;
      const text = document.getElementById('reviewText').value.trim();
      
      let progress = 0;
      if (name.length >= 2) progress += 25;
      if (plan) progress += 25;
      if (currentRating > 0) progress += 25;
      if (text.length >= 10) progress += 25;
      
      document.getElementById('formProgress').style.width = progress + '%';
    }

    // Form setup
    function setupForm() {
      document.getElementById('reviewForm').addEventListener('submit', handleFormSubmit);
    }

    // Handle form submission
    async function handleFormSubmit(e) {
      e.preventDefault();
      
      const submitButton = document.querySelector('.submit-button');
      const spinner = document.getElementById('submitSpinner');
      const submitText = document.getElementById('submitText');
      const alertContainer = document.getElementById('formAlert');
      
      // Clear previous alerts
      alertContainer.innerHTML = '';
      
      // Validation
      if (currentRating === 0) {
        showAlert('Please select a rating', 'error');
        document.querySelector('.star-rating').focus();
        return;
      }
      
      const formData = new FormData(e.target);
      formData.append('rating', currentRating);
      formData.append('action', 'submit_review');
      
      // Show loading state
      submitButton.disabled = true;
      spinner.style.display = 'inline-block';
      submitText.textContent = 'Submitting...';
      
      try {
        const response = await fetch(API_URL, {
          method: 'POST',
          body: formData,
          mode: 'cors'
        });
        
        const result = await response.json();
        
        if (result.status === 'success') {
          showAlert('üéâ Thank you for your review! It will be published after moderation within 24 hours.', 'success');
          resetForm();
          
          // Show success animation
          submitButton.style.background = 'var(--success)';
          setTimeout(() => {
            submitButton.style.background = 'var(--brand-gradient)';
          }, 2000);
          
          // Auto switch to reviews tab after delay
          setTimeout(() => {
            const reviewsButton = document.querySelector('.tab-button:last-child');
            reviewsButton.click();
          }, 3000);
          
        } else {
          showAlert('‚ùå ' + (result.message || 'Error submitting review. Please try again.'), 'error');
        }
      } catch (error) {
        console.error('Submission error:', error);
        if (isOnline) {
          showAlert('üö´ Unable to submit review at this time. Please check your connection and try again.', 'error');
        } else {
          showAlert('üì∂ No internet connection. Please check your network and try again.', 'error');
        }
      } finally {
        // Reset loading state
        submitButton.disabled = false;
        spinner.style.display = 'none';
        submitText.textContent = 'Submit Review';
      }
    }

    // Load reviews
    async function loadReviews() {
      try {
        const response = await fetch(API_URL + '?action=get_reviews', {
          method: 'GET',
          mode: 'cors'
        });
        
        const data = await response.json();
        
        if (data.status === 'success') {
          reviews = data.reviews || [];
          displayReviews();
          updateStats(data.stats);
          updateReviewCount(reviews.length);
        } else {
          console.log('API Error:', data.message);
          loadSampleReviews();
        }
      } catch (error) {
        console.error('Error loading reviews:', error);
        loadSampleReviews();
      }
    }

    // Load sample reviews for demo/offline
    function loadSampleReviews() {
      reviews = [
        {
          name: "Priya Sharma",
          plan: "Annual Plan",
          rating: 5,
          text: "Camva Pro has completely transformed my design workflow. The AI tools are incredible and save me hours every week. The background remover is especially impressive!",
          date: "Aug 05, 2025"
        },
        {
          name: "Raj Kumar",
          plan: "Monthly Plan",
          rating: 5,
          text: "Amazing value for money! The premium templates and AI features make it so easy to create professional designs. Highly recommend for any creator.",
          date: "Aug 04, 2025"
        },
        {
          name: "Anita Singh",
          plan: "Quarterly Plan",
          rating: 4,
          text: "Great tool for social media content creation. Love the brand kit feature that keeps everything consistent across all my designs.",
          date: "Aug 03, 2025"
        },
        {
          name: "Vikash Gupta",
          plan: "Giveaway Winner",
          rating: 5,
          text: "Won the monthly giveaway and absolutely loving Camva Pro! The video editing tools are fantastic and the interface is so user-friendly.",
          date: "Aug 02, 2025"
        },
        {
          name: "Sneha Patel",
          plan: "Annual Plan",
          rating: 5,
          text: "Best design investment I've made for my business. The AI writer and magic resize features have streamlined my entire content creation process.",
          date: "Aug 01, 2025"
        },
        {
          name: "Arjun Mehta",
          plan: "Monthly Plan",
          rating: 4,
          text: "Really impressed with the quality of templates and the ease of use. Customer support is also very responsive and helpful.",
          date: "Jul 30, 2025"
        }
      ];
      
      displayReviews();
      updateStats({
        averageRating: 4.8,
        totalReviews: reviews.length,
        fiveStarPercent: 83,
        recommendPercent: 98
      });
      updateReviewCount(reviews.length);
    }

    // Display reviews in 3D carousel
    function displayReviews() {
      const carousel = document.getElementById('reviewsCarousel');
      const indicators = document.getElementById('carouselIndicators');
      const emptyState = document.getElementById('emptyState');
      
      if (!carousel || !indicators) return;
      
      carousel.innerHTML = '';
      indicators.innerHTML = '';
      
      if (reviews.length === 0) {
        emptyState.style.display = 'block';
        carousel.parentElement.style.display = 'none';
        return;
      }
      
      emptyState.style.display = 'none';
      carousel.parentElement.style.display = 'block';
      
      reviews.forEach((review, index) => {
        // Create review card
        const card = document.createElement('div');
        card.className = 'review-card';
        if (index === 0) card.classList.add('center');
        
        card.innerHTML = `
          <div class="review-header">
            <div class="reviewer-avatar">${review.name.charAt(0).toUpperCase()}</div>
            <div class="reviewer-info">
              <h4>${getShortName(review.name)}</h4>
              <div class="reviewer-plan">${review.plan}</div>
            </div>
          </div>
          <div class="review-stars">
            ${generateStarHTML(review.rating)}
          </div>
          <div class="review-text">${review.text}</div>
          <div class="review-date">${review.date}</div>
        `;
        
        carousel.appendChild(card);
        
        // Create indicator
        const indicator = document.createElement('div');
        indicator.className = 'indicator';
        indicator.setAttribute('role', 'tab');
        indicator.setAttribute('aria-label', `Review ${index + 1}`);
        if (index === 0) indicator.classList.add('active');
        indicator.onclick = () => goToReview(index);
        indicator.onkeydown = (e) => {
          if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            goToReview(index);
          }
        };
        indicator.tabIndex = 0;
        indicators.appendChild(indicator);
      });
      
      currentReviewIndex = 0;
      updateCarouselPosition();
    }

    // Generate star HTML
    function generateStarHTML(rating) {
      let starsHTML = '';
      for (let i = 0; i < 5; i++) {
        if (i < rating) {
          starsHTML += `<svg viewBox="0 0 24 24"><path d="M12 17.3l6.18 4.03-1.64-7.19L21 9.76l-7.27-.63L12 2.5 10.27 9.13 3 9.76l4.46 4.38-1.64 7.19z"/></svg>`;
        } else {
          starsHTML += `<svg viewBox="0 0 24 24" style="fill: #e2e8f0;"><path d="M12 17.3l6.18 4.03-1.64-7.19L21 9.76l-7.27-.63L12 2.5 10.27 9.13 3 9.76l4.46 4.38-1.64 7.19z"/></svg>`;
        }
      }
      return starsHTML;
    }

    // Get short name for privacy
    function getShortName(fullName) {
      const parts = fullName.trim().split(' ');
      return parts.length > 1 ? `${parts[0]} ${parts[1].charAt(0)}.` : parts[0];
    }

    // Carousel navigation
    function nextReview() {
      if (reviews.length === 0) return;
      stopAutoRotate();
      currentReviewIndex = (currentReviewIndex + 1) % reviews.length;
      updateCarouselPosition();
      setTimeout(startAutoRotate, 10000); // Restart after 10s
    }

    function previousReview() {
      if (reviews.length === 0) return;
      stopAutoRotate();
      currentReviewIndex = currentReviewIndex === 0 ? reviews.length - 1 : currentReviewIndex - 1;
      updateCarouselPosition();
      setTimeout(startAutoRotate, 10000); // Restart after 10s
    }

    function goToReview(index) {
      if (reviews.length === 0) return;
      stopAutoRotate();
      currentReviewIndex = index;
      updateCarouselPosition();
      setTimeout(startAutoRotate, 10000); // Restart after 10s
    }

    // Update carousel position with 3D effect
    function updateCarouselPosition() {
      const carousel = document.getElementById('reviewsCarousel');
      const cards = carousel.querySelectorAll('.review-card');
      const indicators = document.querySelectorAll('.indicator');
      
      if (cards.length === 0) return;
      
      // Update card positions and styling
      cards.forEach((card, index) => {
        card.classList.remove('center', 'prev', 'next');
        
        if (index === currentReviewIndex) {
          card.classList.add('center');
        } else if (index === currentReviewIndex - 1 || (currentReviewIndex === 0 && index === cards.length - 1)) {
          card.classList.add('prev');
        } else if (index === currentReviewIndex + 1 || (currentReviewIndex === cards.length - 1 && index === 0)) {
          card.classList.add('next');
        }
      });
      
      // Update indicators
      indicators.forEach((indicator, index) => {
        indicator.classList.remove('active');
        if (index === currentReviewIndex) {
          indicator.classList.add('active');
        }
      });
      
      // Calculate smooth offset for centering
      const cardWidth = 430; // 400px + 30px gap
      const containerWidth = carousel.parentElement.offsetWidth;
      const offset = (containerWidth / 2) - (cardWidth / 2) - (currentReviewIndex * cardWidth);
      
      carousel.style.transform = `translateX(${offset}px)`;
    }

    // Auto-rotate carousel
    function startAutoRotate() {
      if (reviews.length <= 1) return;
      stopAutoRotate(); // Clear any existing interval
      autoRotateInterval = setInterval(() => {
        if (document.getElementById('all-reviews').classList.contains('active')) {
          nextReview();
        }
      }, 6000);
    }

    function stopAutoRotate() {
      if (autoRotateInterval) {
        clearInterval(autoRotateInterval);
        autoRotateInterval = null;
      }
    }

    // Keyboard navigation
    function setupKeyboardNavigation() {
      document.addEventListener('keydown', (e) => {
        if (document.getElementById('all-reviews').classList.contains('active')) {
          if (e.key === 'ArrowLeft') {
            e.preventDefault();
            previousReview();
          } else if (e.key === 'ArrowRight') {
            e.preventDefault();
            nextReview();
          }
        }
      });
    }

    // Update stats with animations
    function updateStats(stats) {
      if (!stats) return;
      
      const elements = {
        averageRating: document.getElementById('averageRating'),
        totalReviews: document.getElementById('totalReviews'),
        fiveStarPercent: document.getElementById('fiveStarPercent'),
        recommendPercent: document.getElementById('recommendPercent')
      };
      
      // Animate numbers
      animateNumber(elements.averageRating, stats.averageRating, 1);
      animateNumber(elements.totalReviews, stats.totalReviews, 0);
      animateNumber(elements.fiveStarPercent, stats.fiveStarPercent, 0, '%');
      animateNumber(elements.recommendPercent, stats.recommendPercent, 0, '%');
    }

    function animateNumber(element, target, decimals = 0, suffix = '') {
      if (!element) return;
      
      const start = 0;
      const increment = target / 30;
      let current = start;
      
      const timer = setInterval(() => {
        current += increment;
        if (current >= target) {
          current = target;
          clearInterval(timer);
        }
        element.textContent = current.toFixed(decimals) + suffix;
      }, 50);
    }

    function updateReviewCount(count) {
      const countEl = document.getElementById('reviewCount');
      if (countEl) {
        countEl.textContent = count;
      }
    }

    // Utility functions
    function showAlert(message, type) {
      const alertContainer = document.getElementById('formAlert');
      if (!alertContainer) return;
      
      alertContainer.innerHTML = `<div class="alert alert-${type}">${message}</div>`;
      alertContainer.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
      
      setTimeout(() => {
        alertContainer.innerHTML = '';
      }, 8000);
    }

    function resetForm() {
      document.getElementById('reviewForm').reset();
      currentRating = 0;
      document.querySelectorAll('.star').forEach(star => star.classList.remove('active'));
      document.getElementById('ratingText').textContent = 'Please select a rating';
      document.getElementById('charCount').textContent = '0';
      document.getElementById('formProgress').style.width = '0%';
    }

    // Handle window resize
    window.addEventListener('resize', () => {
      if (reviews.length > 0) {
        setTimeout(updateCarouselPosition, 100);
      }
    });

    // Handle page visibility change (pause auto-rotate when not visible)
    document.addEventListener('visibilitychange', () => {
      if (document.hidden) {
        stopAutoRotate();
      } else if (document.getElementById('all-reviews').classList.contains('active')) {
        setTimeout(startAutoRotate, 2000);
      }
    });

    // Performance monitoring
    window.addEventListener('load', () => {
      setTimeout(() => {
        if (document.getElementById('all-reviews').classList.contains('active')) {
          startAutoRotate();
        }
      }, 3000);
    });
  </script>
</body>
</html>
